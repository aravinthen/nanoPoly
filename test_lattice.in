#-----------------------------------------------------------------------------------
# NANOPOLY - POLYMER NANOCOMPOSITE SIMULATION FILE                                  
# Full project files can be found at: https://github.com/aravinthen/nanoPoly        
#-----------------------------------------------------------------------------------
# FILENAME: test_lattice.in                                                        
# DATE: 2020-08-24                                                                     
# OVERVIEW:                                                                         
#    Number of polymer chains:     5                     
#    Number of crosslinks:         500           
#    Nanostructure:                None                 
#-----------------------------------------------------------------------------------
                                                                                      
variable structure index test_structure.in                                             
variable simulation index test_lattice.in                                            
                                                                                      
# Initialization settings                                                             
units              lj                                                                 
boundary           p p p                                                              
atom_style         bond                                                       
log                log.${simulation}.txt                                            
                                                                                      
# read data from object into file                                                     
read_data          ${structure}                                                     
                                                                                      
# define interactions                                                                 
neighbor      0.4 bin                                                                 
neigh_modify  every 10 one 10000                                                      
comm_modify   mode single cutoff 1.0 vel yes                                      
pair_style    lj/cut 1.5                                        
pair_coeff    * * 1.0 0.5            
bond_style    fene  
special_bonds fene  
bond_coeff    1 30.0 4.5 1.0 1.0 

#-----------------------------------------------------------------------------------
# EQUILIBRATION STAGE 1                                                 
# Description: Langevin dynamics at 2T*, NVE ensemble.
#-----------------------------------------------------------------------------------
velocity        all create 2.0 1231 
fix             1 all nve/limit 0.5
fix             2 all langevin 2.0 2.0 10.0 63289
thermo_style    custom step temp press 
thermo          1000
reset_timestep  0
run             10000 
unfix 1         
unfix 2         
write_restart   restart.test_lattice.in.polylattice1

#-----------------------------------------------------------------------------------
# EQUILIBRATION STAGE 2                                                 
# Description: Nose-Hoover dynamics at 2T*, NPT ensemble.
#-----------------------------------------------------------------------------------
fix             1 all npt temp 2.0 2.0 1.0 iso 0 0 10.0 drag 2.0 
fix             2 all momentum 1 linear 1 1 1
thermo_style    custom step temp press 
thermo          100
reset_timestep  0
run             10000 
unfix 1         
unfix 2         
write_restart   restart.test_lattice.in.polylattice2

#-----------------------------------------------------------------------------------
# EQUILIBRATION STAGE 3                                                 
# Description: Nose-Hoover dynamics from 2T* to 0.8*, NPT ensemble.
#-----------------------------------------------------------------------------------
fix             1 all npt temp 2.0 0.8 1.0 iso 0 0 10.0 drag 2.0 
fix             2 all momentum 1 linear 1 1 1
thermo_style    custom step temp press 
thermo          100
reset_timestep  0
run             30000 
unfix 1         
unfix 2         
write_restart   restart.test_lattice.in.polylattice3

#-----------------------------------------------------------------------------------
# DEFORMATION STAGE                                                                 
# Description: Deformation procedure, 3e-2 engineering strain at temperture 0.5T*.
#-----------------------------------------------------------------------------------
run             0            
fix		1 all npt temp 0.8 0.8 1.0 y 0 0 1000 z 0 0 1000 drag 2.0  
fix		2 all deform 1 x erate 0.03 units box remap x                             
variable        var_step equal "step"              
variable        var_temp equal "temp"              
variable        var_pxx equal "pxx"              
variable        var_pyy equal "pyy"              
variable        var_pzz equal "pzz"              
variable        var_lx equal "lx"              
variable        var_ly equal "ly"              
variable        var_lz equal "lz"              
fix             datafile all print 100 "${var_step}	${var_temp}	${var_pxx}	${var_pyy}	${var_pzz}	${var_lx}	${var_ly}	${var_lz}" file test_lattice.in.deform.data title "step	temp	pxx	pyy	pzz	lx	ly	lz" screen no 
thermo_style    custom step temp pxx pyy pzz lx ly lz                   
thermo          100                         
reset_timestep  0
run             25000                                
unfix 1                                                
unfix 2                                                
unfix datafile 
